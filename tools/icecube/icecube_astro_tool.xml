<tool id="icecube_astro_tool" name="IceCube" version="0.0.1+galaxy0" profile="23.0">
  <requirements>
    <requirement type="package" version="6.0">unzip</requirement>
    <requirement type="package" version="8.22.2">ipython</requirement>
    <requirement type="package" version="6.0.0">astropy</requirement>
    <requirement type="package" version="1.26.4">numpy</requirement>
    <requirement type="package" version="1.12.0">scipy</requirement>
    <requirement type="package" version="2.25.2">iminuit</requirement>
    <requirement type="package" version="3.8.3">matplotlib</requirement>
    <requirement type="package" version="24.1.0">skyllh</requirement>
    <requirement type="package" version="1.21.4">wget</requirement>
    <requirement type="package" version="0.70.16">multiprocess</requirement>
    <requirement type="package" version="1.2.13">oda-api</requirement>
    <!--Requirements string 'nb2workflow[cwl,service,rdf,mmoda]>=1.3.30 
' can't be converted automatically. Please add the galaxy/conda requirement manually or modify the requirements file!-->
    <requirement type="package" version="7.16.2">nbconvert</requirement>
  </requirements>
  <command detect_errors="exit_code">ipython '$__tool_directory__/${_data_product._selector}.py'</command>
  <configfiles>
    <inputs name="inputs" filename="inputs.json" data_style="paths" />
  </configfiles>
  <inputs>
    <conditional name="_data_product">
      <param name="_selector" type="select" label="Data Product">
        <option value="Analysis_ipynb" selected="true">Analysis_ipynb</option>
        <option value="TS_map" selected="false">TS_map</option>
        <option value="Spectrum" selected="false">Spectrum</option>
        <option value="Likelihood_profile" selected="false">Likelihood_profile</option>
      </param>
      <when value="Analysis_ipynb">
        <param name="src_name" type="text" value="NGC 1068" label="src_name" />
        <param name="RA" type="float" value="40.669622" label="RA (unit: deg)" />
        <param name="DEC" type="float" value="-0.013294" label="DEC (unit: deg)" />
        <param name="T1" type="text" value="2000-10-09T13:16:00.0" label="T1" />
        <param name="T2" type="text" value="2022-10-10T13:16:00.0" label="T2" />
      </when>
      <when value="TS_map">
        <param name="RA" type="float" value="40.669622" label="RA (unit: deg)" />
        <param name="DEC" type="float" value="-0.013294" label="DEC (unit: deg)" />
        <param name="Radius" type="float" value="1.0" label="Radius (unit: deg)" />
        <param name="pixel_size" type="float" value="0.2" label="pixel_size (unit: deg)" />
        <param name="TSmap_type" type="select" label="TSmap_type">
          <option value="Fixed_slope" selected="true">Fixed_slope</option>
          <option value="Free_slope">Free_slope</option>
        </param>
        <param name="Slope" type="float" value="3.0" label="Slope" />
      </when>
      <when value="Spectrum">
        <param name="RA" type="float" value="40.669622" label="RA (unit: deg)" />
        <param name="DEC" type="float" value="-0.013294" label="DEC (unit: deg)" />
        <param name="Spectrum_type" type="select" label="Spectrum_type">
          <option value="Fixed_slope" selected="true">Fixed_slope</option>
          <option value="Free_slope">Free_slope</option>
        </param>
        <param name="Slope" type="float" value="3.0" label="Slope" />
      </when>
      <when value="Likelihood_profile">
        <param name="RA" type="float" value="308.65" label="RA (unit: deg)" />
        <param name="DEC" type="float" value="40.9" label="DEC (unit: deg)" />
        <param name="sigma" type="float" value="0.7" label="sigma (unit: deg)" />
        <param name="T1" type="text" value="2000-10-09T13:16:00.0" label="T1" />
        <param name="T2" type="text" value="2022-10-10T13:16:00.0" label="T2" />
        <param name="Slope" type="float" value="3.0" label="Slope" />
      </when>
    </conditional>
  </inputs>
  <outputs>
    <data label="${tool.name} -&gt; TS_map picture" name="out_TS_map_picture" format="auto" from_work_dir="picture_galaxy.output">
      <filter>_data_product['_selector'] == 'TS_map'</filter>
    </data>
    <data label="${tool.name} -&gt; TS_map image" name="out_TS_map_image" format="auto" from_work_dir="image_galaxy.output">
      <filter>_data_product['_selector'] == 'TS_map'</filter>
    </data>
    <data label="${tool.name} -&gt; Spectrum spectrum_png" name="out_Spectrum_spectrum_png" format="auto" from_work_dir="spectrum_png_galaxy.output">
      <filter>_data_product['_selector'] == 'Spectrum'</filter>
    </data>
    <data label="${tool.name} -&gt; Spectrum spec_params_astropy_table" name="out_Spectrum_spec_params_astropy_table" format="auto" from_work_dir="spec_params_astropy_table_galaxy.output">
      <filter>_data_product['_selector'] == 'Spectrum'</filter>
    </data>
    <data label="${tool.name} -&gt; Likelihood_profile likelihood_profile_png" name="out_Likelihood_profile_likelihood_profile_png" format="auto" from_work_dir="likelihood_profile_png_galaxy.output">
      <filter>_data_product['_selector'] == 'Likelihood_profile'</filter>
    </data>
    <data label="${tool.name} -&gt; Likelihood_profile likelihood_profile_table" name="out_Likelihood_profile_likelihood_profile_table" format="auto" from_work_dir="likelihood_profile_table_galaxy.output">
      <filter>_data_product['_selector'] == 'Likelihood_profile'</filter>
    </data>
  </outputs>
  <tests>
    <test expect_num_outputs="0">
      <conditional name="_data_product">
        <param name="_selector" value="Analysis_ipynb" />
        <param name="src_name" value="NGC 1068" />
        <param name="RA" value="40.669622" />
        <param name="DEC" value="-0.013294" />
        <param name="T1" value="2000-10-09T13:16:00.0" />
        <param name="T2" value="2022-10-10T13:16:00.0" />
      </conditional>
      <assert_stdout>
        <has_text text="*** Job finished successfully ***" />
      </assert_stdout>
    </test>
    <test expect_num_outputs="2">
      <conditional name="_data_product">
        <param name="_selector" value="TS_map" />
        <param name="RA" value="40.669622" />
        <param name="DEC" value="-0.013294" />
        <param name="Radius" value="1.0" />
        <param name="pixel_size" value="0.2" />
        <param name="TSmap_type" value="Fixed_slope" />
        <param name="Slope" value="3.0" />
      </conditional>
      <assert_stdout>
        <has_text text="*** Job finished successfully ***" />
      </assert_stdout>
    </test>
    <test expect_num_outputs="2">
      <conditional name="_data_product">
        <param name="_selector" value="Spectrum" />
        <param name="RA" value="40.669622" />
        <param name="DEC" value="-0.013294" />
        <param name="Spectrum_type" value="Fixed_slope" />
        <param name="Slope" value="3.0" />
      </conditional>
      <assert_stdout>
        <has_text text="*** Job finished successfully ***" />
      </assert_stdout>
    </test>
    <test expect_num_outputs="2">
      <conditional name="_data_product">
        <param name="_selector" value="Likelihood_profile" />
        <param name="RA" value="308.65" />
        <param name="DEC" value="40.9" />
        <param name="sigma" value="0.7" />
        <param name="T1" value="2000-10-09T13:16:00.0" />
        <param name="T2" value="2022-10-10T13:16:00.0" />
        <param name="Slope" value="3.0" />
      </conditional>
      <assert_stdout>
        <has_text text="*** Job finished successfully ***" />
      </assert_stdout>
    </test>
  </tests>
</tool>